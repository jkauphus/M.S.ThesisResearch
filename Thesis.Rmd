---
title: "The Swamp Generalist; *Agkistrodon piscivorus*"
author: "Jack Kauphusman"
date: "12/10/2019"
output:
    rmdformats::readthedown:
      self_contained: true
      thumbnails: true
      lightbox: true
      gallery: false
      highlight: tango
      use_bookdown: true
      fig_height: 12
      fig_width: 12
      html_document:
      code_folding: "hide"
      
---

<center>![Fulbright,2013](data/Spring cottonmouth .jpg){width=70%}</center>


```{r Library, include=FALSE}
packages<-c("adehabitatHR","ggmap","dismo","rgbif","rdryad","utils","readxl","ggridges","viridis","rasterVis","maps","mapdata","raster",
"rasterImage", "data.table","ggfortify","grid","move","moveVis","OpenStreetMap","pbapply","plotly",
"rgdal","sp","tidyverse", "dplyr", "ggplot2", "factoextra", "FactoMineR", "tidyr", "knitr", "gridExtra", "lattice", "permute", "vegan", "RVAideMemoire", "MASS", "caret", "tmap", "tmaptools", "ggsn", "leaflet", "sf", "sp", "ggmap", "randomForest", "randomForestExplainer", "rfUtilities", "faraway", "ROCR", "formattable", "kableExtra", "cowplot", "ggforce", "ggrepel", "ggExtra", "gt", "glue", "Boruta", "pdp", "ggpubr", "scales")
sapply(packages, require, character.only=T)
```

# **Abstract**

  Many snake species exhibit an ontogenetic shift in habitat preferences, as this can potentially reduce interspecific competition. We investigated the habitat selection of a Tennessee population of cottonmouths inhabiting an isolated wetland system adjacent to the Cumberland River. Field collection was by visual-encounter surveys, and individuals were measured and sexed. Principle component analysis was used to elucidate intraspecific trends in habitat selection between male, female, and juvenile cottonmouths (N = 151). We found that cottonmouths exhibited non-random habitat use, with respect to available habitat features, and there were significant habitat differences among intraspecific groups. The results suggest that cottonmouths do change habitat use through ontogeny as from drier habitats to wetter habitats. This may be a mechanism to reduce intraspecific competition. However, among the cottonmouths each group (male, female, and juvenile) had large variations in habitat use, emphasizing that they are habitat generalists utilizing a wide variety of resources. In addition, the results showed females and juveniles had the highest variations in habitat preferences compared to males. We suggest that trends in ontogenetic shifts in habitat use may be associated more with actively avoiding larger individuals, than specific differences in habitat preference.

# **Introduction**

Wetlands are productive and biologically diverse systems that provide resources for a variety of wildlife species during part or all of their life stages (Mitsch and Gosselink 2000). Wetlands are often viewed as transitional ecosystems connecting terrestrial and aquatic systems, where fluctuations in hydrology can influence wetland boundaries to encroach or recede from the upland habitats (Brinson 1993). These wet-dry hydrologic fluctuations can cause habitat to become periodically unsuitable and resource-limited, as areas can become either too flooded or too dry (Brinson 1993). Fluctuations are typically both seasonal and stochastic and can cause some species to use wetland areas only during favorable conditions (i.e. specialists), or adopt more general use as the hydrological environmental changes (i.e. generalists) (Mitsch and Gosselink 2000, Devictor et al. 2008). As geomorphology shapes catchment area and water level retention in wetland systems, different wetland types have varying hydroperiods which range from more stable seasonal-depressional wetlands (Winter and Rosenberry 1998, Mitsch and Gosselink 2000) to highly variable riverine-floodplains (Junk et al. 1989). These differing wetland associations may conditionally favor certain strategies of habitat use, specifically, habitats with heterogenous environments and frequent disturbance regimes are typically colonized successfully by generalist species (Macarthur and Wilson 1967, Adler and Wilson 1987, Fournier et al. 2015, Büchi and Vuilleumier 2016). 

![Mitsch & Gosselink, 2001](data/Wetlands.gif)

As environmental factors largely shape life history strategies at the broader scale, resource availability and competition may also play a role in determining habitat use at smaller scales (Mayor et al. 2009), where competitive exclusion forces organisms to alter their strategy of resource exploitation to become either highly specialized or adapt broad use of diets and habitats (Greenbaum 2004, Steen et al. 2014). As interspecific competition shapes evolutionary strategies of resource use between species (Levin 1970), so too does intraspecific competition (Amarasekare 2003). Intraspecific competition is thought to be more prevalent within species, so to avoid the limiting effects, inferior competitors tend to select resources not exploited by the superior (Bolnick 2004).
A semi-aquatic species that is commonly found in a variety of wetland habitats throughout the southeastern United States is the cottonmouth (Agkistrodon piscivorus). Cottonmouths are dietary generalists, consuming anurans, fish, invertebrates, lizards, snakes, turtles, and smaller conspecifics (Gloyd and Conant 1990, McKnight et al. 2014). Cottonmouths are considered “habitat generalists” (Gloyd and Conant 1990, Enst and Ernst 2011), as they are found in many different aquatic-associated habitats, such as high elevation streams (Hill and Beaupre 2008), depressional wetlands (Eskew et al. 2009, Delisle et al. 2019b), and river floodplains (Ford et al. 2004, Roth 2005). 
Cottonmouths can also be abundant within appropriate habitats (Ford 2002), and often can have subtle differences in habitat selection across ontogeny (Eskew et al. 2009) and seasonal habitat selection differences between sexes (Delisle et al. 2019a, 2019b). Ontogenetic shifts in habitat selection and diet are thought to be a common competitive exclusion strategy in reptiles (Vitt 2000, Shine et al. 2003), and differences in habitat use between sexes in pit-vipers is relatively commonly (Reinert 1984, Pearson et al. 2002). However, populations inhabiting highly dynamic environments with high frequencies of disturbance may promote niche overlap and reduce habitat specialization among residents (Marvier et al. 2004, Mason et al. 2011, Durso et al. 2013, Smith et al. 2018, Stireman and Singer 2018). As cottonmouth populations occupy a variety of wetland habitats, populations inhabiting heterogeneous environments with frequent disturbance regimes should cause habitat selection to be driven predominantly by local environmental fluctuations rather than by population interactions

In this study, we sought to understand the habitat niche space of an isolated population of cottonmouths found within a riverine wetland slough along a transitional wetland gradient. We hypothesize that cottonmouths use generalist habitat selection as an adaptation to hydrologically dynamic ecosystems. To examine cottonmouth habitat niche space and habitat use, we (i) investigated cottonmouth use of the available habitat, (ii) determined whether there was a presence of intraspecific differences in habitat use among conspecifics, and (iii) determined which environmental factors promoted (were most predictive of) the occurrence of cottonmouths within our study area. 

# **Background**

The species *A. piscivorus* are located throughout the southeast United States, and are predominenty found near wetland habitats, such as marshes, riverine sloughs, and swamps (Parkinson et al. 2000, Porras et al. 2013). 

```{r Cottonmouth Data, fig.width = 8, fig.height = 8, message=FALSE, warning=FALSE, cache = TRUE}
extent <- extent(-94,-78,25,40)

# DISMO and GBIF 

agk_dismo <- gbif("agkistrodon", species = "piscivorus", ext = extent,
             geo = TRUE, sp = TRUE, download = TRUE,
             removeZeros = TRUE)

agk_xy <- as.data.frame(cbind(agk_dismo@coords[,1],agk_dismo@coords[,2]))
colnames(agk_xy) <- c("longitude","latitude")

agk_xy<-cbind(agk_xy, data.frame("Species" = "Cottonmouth"))

us <- map_data("state")
#Outmap
state <- map_data("state")
county <- map_data("county")
study_site <- data.frame("x" = -87.092447, "y" = 36.288684)
tn <- county %>% 
  filter(region=="tennessee")

Cheatham <- county %>% 
  filter(region=="tennessee") %>% 
  filter(subregion=="cheatham")


#Creating Distribution Map

ggplot(data = agk_xy, aes(x=longitude, y=latitude)) +
  geom_polygon(data = us, aes(x=long, y = lat, group = group), fill = "dark green", color="black") +
  geom_polygon(data = tn, aes(x=long, y = lat, group = group), fill = "dark green", color = "black") + 
  geom_point(aes(x=longitude, y=latitude), color = "red") +
  stat_density2d(aes(fill = stat(level)), alpha= .25, geom = "polygon", data = agk_xy, n = 40)+
  scale_fill_gradient(low="yellow", high = "red")+
  geom_polygon(data = Cheatham, aes(x=long, y = lat, group = group), shape = 5,fill = "Dark Blue", color="black") + 
  xlab("Longitude") + 
  ylab("Latitude") +
  coord_fixed(xlim = c(-94,-77), ylim = c(25,40))+
  theme(panel.background = element_rect(fill = "lightblue"))+
  theme(legend.position=c(0.95, 0.88), legend.background = element_rect(fill="White",
      size=0.5, linetype="solid", colour ="black"))+
  ggtitle("Cottonmouth Species Distribution Map")+
  theme(plot.title = element_text(hjust = 0.5))
```

**Map 1:** The distribution of cottonmouth (*A. piscivorus*) throughouth the continental United States based on museum specimens from the GBIF database (https://www.gbif.org/). The study area was conducted in Cheatham County, TN, which is highlighted in dark blue. 

# **Methods**
```{r Dataset}
study<-read.csv("data/CottonmouthTotal-11-27.csv")
```
## Study Area

Data was collected along the Cumberland River Bicentennial Trail (CRBT), Cheatham County, Tennessee, USA (36˚17’ N, 87˚05’W). The site is a mixture of lowland forest, slough wetlands, upland limestone bluffs, and rocky outcrops. Cottonmouths use the upland forest and limestone bluffs as overwintering sites and occupy the lowland forest slough during the active season. The site is bordered by limestone bluffs and backwater streams along the northern portions, the Cumberland River along the west and south, and crop fields and urban development along the southern portions. These landscape features appear to largely isolate the population from dispersal and unpublished telemetry data (Smith 2009, Fulbright 2014) noted that snakes did not leave the approximately 76 hectare study area. 

```{r Interactive Ploty Map,  message=FALSE, warning=FALSE, cache = TRUE}
#Setting Up Coordinates

coord<-cbind(study$UTM_mE, study$UTM_mN)
coord_locations<-SpatialPoints(coord,
                               proj4string = CRS("+proj=utm +zone=16 +datum=WGS84"))
lat.lon<- as.data.frame(spTransform(
  coord_locations, CRS("+proj=longlat +datum=WGS84")))
colnames(lat.lon)<-c("x","y")

study<-cbind(study,lat.lon)

#Subsets of Dataset

habitat<- study %>% subset(Type == "GENERAL")
snake<- study %>% subset(Type == "SNAKE")

#Raster from OSM

raster <- openmap(c(max(lat.lon$y)+0.01, min(lat.lon$x)-0.01), 
                  c(min(lat.lon$y)-0.01, max(lat.lon$x)+0.01), 
                  type = "bing")

raster_utm <- openproj(raster, 
              projection = "+proj=longlat +datum=WGS84")

autoplot(raster_utm, expand = TRUE) + theme_bw() +
  theme(legend.position="bottom") +
  geom_point(data=snake, aes(x,y, shape=Group, color = Group), size = 2.5, alpha = 0.8) +
  scale_shape_manual(values = c(15,16,17,18))+
  coord_fixed(xlim = c(min(habitat$x),max(habitat$x)), ylim = c(min(habitat$y),max(habitat$y)))+
  theme(axis.title = element_text(face="bold")) + labs(x="Longitude",
        y="Latitude")+
  ggtitle("Study Area")+
  theme(plot.title = element_text(hjust = 0.5))
```

**Map 2:** The locations cottonmouths were found within the study area during the active seasons (May - October) of 2012, 2013, & 2019.

The habitat types found within the study area are the buttonbush slough in the central portion (12.6 ha), characterized by relatively open canopy, deeper water (50-150 cm), and mats of floating vegetation (Hydrocotyle ranunculoides & Ludwigia palustris) scattered throughout the slough. An open water habitat (> 100cm) is located toward the western portion of the study area. The seasonally flooded lowland forest (20.9 ha), dominated by red maples (Acer rubrum), has the denser canopy closure for the wetland, and is located between the slough and upland forest. Toward the southern portion between the slough and crop fields is a transitional edge area (15.4 ha) dominated by dense grass vegetation and occasionally floods (<10cm) in some portions throughout the year.  The upland forest habitat (16.3 ha) was dominated by oak trees (Quercus sp.) and had dense canopy closure and higher percentage of bare soil. Three main streams flow into the slough from the upland forest and provide a permanent source of water to the slough, along with periodic flooding from the Cumberland River, and groundwater seepage. A constructed levee divides the slough from adjacent crop fields, and during the fall waterfowl hunt, a culvert is opened from the levee to reduce the flooded areas.

```{r Hydro Graphs, fig.height=8, fig.width=10}
gauge<-read.csv("data/GaugeData-USGS.csv")
gauge[,2]<-as.Date(gauge[,2])
gauge[,4]<-gauge[,3]*0.3048

p1<-ggplot(gauge, aes(x =gauge$datetime, y= gauge$V4))+
  geom_line(color = "blue")+
  xlab("")+
  ylab("Gauge Height (m)")+
  ggtitle("USGS 03435000 Cumberland River Below Cheatham Dam, TN")+
  theme_classic(base_size = 14)

p1<-p1+scale_x_date(breaks=date_breaks("6 months"), labels = date_format("%b %y"))

discharge<-read.csv("data/SycamoreData-USGS.csv")
discharge[,2]<-as.Date(discharge[,2])
discharge[,4]<-discharge[,3]*0.0283168

p2<-ggplot(discharge, aes(x =discharge$datetime, y= discharge$V4))+
  geom_line(color = "steelblue3")+
  xlab("")+
  ylab("Discharge (cubic meters per second)")+
  ggtitle("USGS 03431800 Sycamore Creek Near Ashland City, TN")+
  theme_classic(base_size = 14)

p2<-p2+scale_x_date(breaks=date_breaks("6 months"), labels = date_format("%b %y"))

plot_grid(p1,p2, ncol = 1, nrow = 2)
```
**Hydrograph** Above graph depicts the gauge height of the  Cumberland River below the Cheatham Dam, TN. Data was taken at (COORDINATES), and can be found on the USGS Water Resources Website


## Field Collection 

We conducted visual encounter surveys during the active seasons (April – October) and snakes were captured using tongs and retained in plastic restraining tubes (Midwest Tongs). For individual identification, each snake was implanted subcutaneously with a Passive Integrated Transponder (PIT) tag (Biomark) on the ventral side, posterior to midbody. Tags and implant syringes were soaked in Benzalkonium Chloride (Benz-all) for 2 – 3 minutes prior to tag implantation, and an antiseptic liquid bandage (Vetclose) was applied to the insertion area to facilitate healing. Snout-vent length (SVL) and tail lengths (TL) were measured, and snakes were sexed by either everting hemipenes or by probing (Blanchard and Finister 1933). Individuals were considered adults if their SVL were greater than 500-mm, individuals with an SVL between 300 – 500-mm were considered juveniles (Burkett 1966, Eskew et al. 2009), and neonates were considered to be individuals less than 300-mm SVL (Koons et al. 2009). Body mass was measured with a Pesola spring scale. 

Habitat selection was quantified by recording a suite of biotic and abiotic environmental variables that shared the transitional wetland gradient relationship from terrestrial to aquatic habitat, (Table 1) at the location in which the individual was first sighted. A 1-m2 quadrat was used to assess the habitats available compared to those selected by cottonmouths; a combination of randomly chosen and fixed sites were measured. A randomly chosen comparison site was paired with each snake location using the Random Points Tool in ArcMap (ESRI) within the study area. Secondarily, a grid of 40 systematically selected fixed sites were placed ~200-m from one another using the Fishnet Tool in ArcMap, to assure all available habitats in the study area were quantified. 

To test if cottonmouths are generalist or specialist in habitat selection, we used the National Land Cover Dataset (NLCD, 2011), by the USGS downloaded from Google Earth Engine (https://earthengine.google.com/), to identify the habitats cottonmouths were located within. Land cover types were generalized to three categories; Terrestrial, Aquatic, and Wetland.

```{r Land Cover,fig.width = 8, fig.height = 8, message=FALSE, warning=FALSE}
landcover<-raster("data/Habitat/Land_Classification.tif")

# Converting projection of raster

projection(landcover)<-CRS("+proj=longlat +ellps=WGS84")

#Extracting Values
lat.lon<-data.frame(cbind(study$x,study$y))

results<-data.frame(raster::extract(landcover$Land_Classification, SpatialPoints(lat.lon), sp = T))

study<-cbind(study,results$Land_Classification)

#Changing values 
levels(study$`results$Land_Classification`)<-c(levels(study$`results$Land_Classification`), c("Aquatic", "Wetland","Terrestrial"))
study$`results$Land_Classification`[study$`results$Land_Classification`<=11] <- "Aquatic"
study$`results$Land_Classification`[study$`results$Land_Classification`>11 & study$`results$Land_Classification`< 89] <- "Terrestrial"
study$`results$Land_Classification`[study$`results$Land_Classification`>=90 & study$`results$Land_Classification`<= 95]<- "Wetland"
```

```{r Mapping NLCD}
rast<-rasterToPoints(landcover)
rast<-data.frame(rast)
colnames(rast)<-c("X","Y", "Landcover")
b.rast<-seq(min(rast$Landcover), max(rast$Landcover), length.out = 30)
rast$Landcover<-as.character(rast$Landcover)
 
ggplot()+
geom_raster(data = rast,aes(X, Y, fill = Landcover))+
  scale_fill_manual(values= c("light blue", "forestgreen","forestgreen","forestgreen","forestgreen","forestgreen","forestgreen",
                               "forestgreen","forestgreen","forestgreen","forestgreen","forestgreen","forestgreen","Dark blue", "Dark blue"))+
  geom_point(data = snake, aes(x,y), size = 2)+
  coord_fixed(xlim = c(min(habitat$x),max(habitat$x)), ylim = c(min(habitat$y),max(habitat$y)))+
  theme(panel.border = element_rect(colour = "black", fill = NA, size = 1))+
  labs(x = "Longitude", y = "Latitiude")+
  ggtitle("USGS: National Land Cover Database")+
  theme(plot.title = element_text(hjust = 0.5))+
  theme(legend.position= "bottom")
```


**Map 3:** The USGS: National Land Cover Dataset of 2011 downloaded from the Google Earth Engine. CLassification definitions can be found at (https://developers.google.com/earth-engine/datasets/catalog/USGS_NLCD). Cottonmouth locations are identified by the black points on the map. Green indicates terrestrial habitat, light blue indicates deep-water habitats, and dark blue indicates wetland habitats. 

## Analysis of Habitat Selection: Ecological Niche 

The concept of the ecological niche was used as a framework to analyze the range of environmental variables cottonmouths selected within the general habitats available. A correlation matrix was used to identify colinear environmental variables, and variables with a coefficient above 0.70 were removed from analysis (Dormann et al. 2013). We found land cover and water cover to be highly correlated as well as three temperature variables; ambient, surface, and substrate temperature. Therefore, we chose to remove land cover and substrate temperature, while averaging both surface and ambient temperature to a single mean temperature variable, leaving 16 environment variables for analysis (Table 1). We used Principal Component Analysis (PCA) on correlations to reduce dimensionality of the environmental variables to better interpret the variation within each habitat dimension to elucidate trends of cottonmouth habitat niche width. Each dimension was ranked based on explained variance (Peres-Neto et al. 2003) and we retained the first three principal components for further analysis.PCA was performed using R (www.r-project.org) and plotted using ggplot2 package (WICKHAM 2016).  

As PCA is predominantly a visual analysis, we used a Permutational Multivariate Analysis of Variance (PERMANOVA; 9999 permutations) and Permutational analysis of multivariate dispersion (PERMDISP; 9999 permutations) on Euclidean distances to determine whether cottonmouth habitat was significantly different than habitat available in multivariate space. PERMANOVA tests for discrimination between groups within multivariate space, and a significant p-value (α =0.05) indicates that groups differ as a function of their distances between centroid locations, their relative dispersion of variance, or both (Anderson 2001). The advantages of PERMANOVA are that it does not assume normality and homogeneity of variance compared to a MANOVA (Delgado-Baquerizo et al. 2015). PERMDISP tests for homogeneity of multivariate dispersion among groups, and is used to determine whether dispersion is the leading cause of significance in the PERMANOVA test (Anderson et al. 2006, Assis et al. 2013). A significant p-value from PERMDISP indicates that dispersion is heterogeneous between groups in multivariate space (Anderson et al. 2006). PERMANOVA/PERMDISP tests were computed in R using the vegan package (Oksanen et al. 2019). 

## Analysis of Habitat Selection: Intra-specific Differences 

To test for intra-specific differences in habitat selection, an ANOVA (Analysis of Variance) was used to compare conspecific group component scores (adult males, adult females, juveniles, and neonates) and was followed by Tukey’s HSD post-hoc tests. Linear regression was used to evaluate the presence of an ontogenetic shift in habitat use by comparing snake SVL with individual component scores (Eskew et al. 2009). 

## Analysis of Habitat Selection: Modeling Habitat Preference 

Random Forest (RF) classification (Breiman 2001) was used to identify the important environmental variables that predict cottonmouth habitat selection. RF is a nonparametric classification method that builds an ensemble model based on a large set of decision trees. For each tree, a bootstrap sample of approximately 64% (i.e., bag sample) was used as a training set, and the remaining data left out as a validation set (i.e., out-of-bag [OOB]) (Breiman 2001, Severson et al. 2017). RF uses all constructed trees within a model to predict and estimate the overall OOB error rate, which is treated as a metric of model accuracy (Breiman 2001, Cutler et al. 2007, Severson et al. 2017).

We constructed an optimal model for classifying cottonmouth habitat selection from the measured environmental variables using cottonmouth occurrence sites compared to available habitat sites as pseudo-absences. We applied 30-iterations of RF models, using the randomForest package (Breiman et al. 2018), where each iteration used 6,000 decision trees on a 10-fold cross-validation training set (similar to Severson et al. 2017). Next, a cross-validation test set was applied to calculate mean model accuracy and identify a minimal error rate model. To further improve model performance, we ran the first RF model applying the Model Improvement Ratio (MIR, Murphy et al., 2010) technique to improve model parsimony by identifying the minimum number of variables to include. The model that had the minimum number of variables with the minimum OOB error rate was selected for model iterations.

RF Model performance was evaluated by the minimum, maximum, and mean OOB accuracy from the 30-iterations. The independent validation set from cross validation was used to assess model accuracy, sensitivity (the proportion of cottonmouth habitat correctly classified), specificity (the proportion of general habitat presence correctly), the area under the curve of a Receiver Operator Characteristic (AUC; a measure of how evenly the model predicts sensitivity and specificity), and the Kappa statistic (a measure of how much better the model predicted cottonmouth and general habitat than expected by random chance) (Cutler et al. 2007). 

To assess the importance of each environmental variable in predicting cottonmouth locations we used the minimal error rate model to produce the feature importance based on the Mean Decrease Accuracy (MDA), a variable importance metric within a RF model, which is computed by permutating OOB samples and each predictor variable, and then the difference between the two are averaged over all trees (Han et al. 2016). The MDA for variables classifying cottonmouth habitat was used to calculate relative importance for each environmental variable. Partial dependence plots were constructed from the six most important environmental variables to illustrate the relationship of the environmental variables to predict cottonmouth habitat selection. 


# **Results**
```{r General Statistics, message=FALSE, warning=FALSE}
#Subsetting Groups
male<- study %>% subset(Group == "MALE")
female<- study %>% subset(Group == "FEMALE")
juvenile<- study %>% subset(Group == "JUVENILE")
YOY<- study %>% subset(Group == "YOY")
```
We surveyed on 96 days during three-years of field study and recorded sixteen environmental variables for the initial sightings of `r nrow(snake)` cottonmouths and `r nrow(habitat)` available habitat comparison sites (134 random and 40 systematic sites). Captured individuals included `r nrow(male)` adult males,`r nrow(female)` adult females, `r nrow(juvenile)` juveniles, and `r nrow(YOY)` neonates. Adult males averaged in `r mean(male$SVL)` ± `r sd(male$SVL)` mm in SVL, adult females `r mean(female$SVL)` ± `r sd(female$SVL)`mm, juveniles `r mean(juvenile$SVL)` ± `r sd(juvenile$SVL)` mm, and neonates `r mean(YOY$SVL)` ± `r sd(YOY$SVL)`mm. During spring (April – May) surveys we found 48 individuals during 20 outings to the study area, 84 individuals during 64 outings in the summer (June – August), and 17 individuals during 12 outings in the fall (September – October). 

## Habitat Selection: Ecological Niche 

The first three principal components describing cottonmouth habitat choice collectively explained 43.6% of the variation within the environmental variable structure (Table 1). Environmental variables associated with PC-1 describe a terrestrial to aquatic gradient where distance to water was positively associated, while percent water and water depth were negatively associated. PC-2 described availability of cover objects, where log diameter and fallen log cover were positively associated and PC-3 described vegetation cover, where vegetation cover was positively associated with cottonmouth habitat. Collectively, the three components explain an environmental gradient between flooded and non-flooded habitat along with available refuge cover, where cottonmouths were more associated with aquatic sites and cover objects.

The PERMANOVA/PERMDISP tests, used to verify the structural relationship between cottonmouth habitat selection and available habitat, found a difference between the groups within multivariate space (PERMANOVA; P< 0.001; Pseudo-F = 19.9; df = 1). Specifically, the results from the PERMDISP test showed that differences between cottonmouths and available habitat sites were attributed to the heterogeneous distribution of variance of the environmental variables between the two groups (PERMDISP; P<0.01; F = 13.9; df = 1). The average distance to centroid location among ellipsoids in multivariate space (Fig 1.), based on PERMDISP, found that available habitat was 4.02, while cottonmouth habitat was 3.26. The PERMANOVA/PERMDISP tests confirmed observations from PCA, in that the heterogeneous dispersion between cottonmouth habitat selection and habitat available shows that cottonmouths partitioned use of habitat resources within the available habitat (Fig 1). In addition, the restricted distribution of cottonmouth habitat in relation to available habitat was due to avoidance of upland habitats during the active season, in favor of occupying aquatic-associated sites (likely foraging sites) within the more hydrologically dynamic slough.

```{r Variable Manipulation, message=FALSE, warning=FALSE, include=FALSE}
Temp<-(study$Surface.Temp+study$Ambient.Temp)/2
study<-cbind(study,Temp)
s<-study[,c(3,9,10,11,12,13,15,16,17,18,19,20,22,23,25,26,27,28,37,38,39,40)]
s<-na.omit(s)
head(s)
```

```{r Drop Column Feature Selection, eval=FALSE, message=FALSE, warning=FALSE, include=FALSE}
rf<-s
#Correlation Check
corrrel<-cor(rf[,c(2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,22)])
findCorrelation(corrrel, cutoff = 0.7)
```

```{r PCA, fig.height=9, fig.width=10, message=FALSE, warning=FALSE}
s1<-s[,c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22)]
#Log Diameter was removed

#PCA
pc<-princomp(s1[,c(2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,22)], cor = T, scores = T)

#Component
#Setting- Up ANOVA
comp<-pc$scores[,1:3]
s1<-cbind(s1, comp)

#Snake Averages
group<- s1 %>% subset(Type == "SNAKE")

pcomp<-group_by(group, Group)%>%
  summarise(Comp.1 = mean(Comp.1),
            Comp.2 = mean(Comp.2),
            Comp.3 = mean(Comp.3))

#Plot Type
gg_scatter1<-ggplot(data = s1, aes(Comp.1, Comp.2, color = Type))+
  geom_point(size = 3.1)+
  scale_color_manual(values = c("hotpink3","black","palegreen4","navyblue", "tomato2","grey44"))+
  theme_bw(base_size = 24)+
  theme(panel.grid = element_blank(), panel.border = element_rect(fill= "transparent"))+
  geom_hline(yintercept = 0, lty = 2) +
  geom_vline(xintercept = 0, lty = 2)+
  xlim(-6,6)+
  ylim(-4.5,4.5)+
  stat_ellipse(type = "norm", aes(fill = Type), 
               show.legend = FALSE,size = 1, level = 0.95, linetype = 2)+
  scale_fill_manual(values=c("black", "#636363"))+
  geom_text(aes(4.3,2.7), label = paste("Cottonmouth"), col = "grey44", size = 9)+
  geom_text(aes(3,-3.7), label = paste("Habitat"), col = "black", size = 9)+
  xlab(expression(atop("aquatic sites" %<->% "terrestrial sites", paste("PC-1 (22.6%)" ))))+
  ylab(expression(atop ("PC-2 (11.8%)", paste("low cover " %<->% "high cover"))))+
  theme(legend.position="none", legend.background = element_rect(fill="White",
      size=0.5))

p<-gg_scatter1+ geom_point(data = pcomp, aes(pcomp$Comp.1, pcomp$Comp.2, shape = Group, color =Group), size = 7, alpha= 0.8)+
  scale_shape_manual(values = c(15,16,17,18))+
  annotate("label", x = 0.41, y = 0.41, label = "FEMALE", color ="hotpink3")+
  annotate("label", x = -1.1, y = 1.2, label = "JUVENILE", color ="palegreen4")+
  annotate("label", x = -0.5, y = -0.1, label = "MALE", color ="navyblue")+
  annotate("label", x = 0.15, y = 1.65, label = "NEONATE", color ="tomato2")
```
**Table 1:** Factor loadings from principal component analysis of environmental variables measured for cottonmouths and general habitat comparitsion sites

```{r Loadings Table, message=FALSE, warning=FALSE}
Description<- c("Percentage of canopy above quadrat", "Coverage within quadrat","Coverage within quadrat","Coverage within quadrat","Coverage within quadrat", "Height of largest living woody stem", "Height of cover object closest to snake point", "Distance to nearest cover object", "Diameter of largest log within quadrat", "Distance to nearest water source", "Water depth measured within quadrat", "Coverage within quadrat","Coverage within quadrat","Coverage within quadrat", "Coverage within quadrat","Mean temperature within quadrat", "", "")

loadings<-pc$loadings[,1:3]
sdev<-t(data.frame(pc$sdev))
eigen<-sdev[,1:3]
Variance<-c(22.60, 11.81, 9.27)
loadings<-rbind(loadings, eigen, Variance)
loadings<-round(loadings, digits = 3)
names(loadings)<-c("PC-1", "PC-2", "PC-3")
loadings<-round(loadings, digits = 3)
loadings<-cbind(Description, loadings)

row.names(loadings)<-c("Canopy Closure (%)", "Rock Cover (%)", "Leaf Cover (%)", "Vegetative Cover (%)", "Fallen Log Cover (%)","Woody Stem Height (cm)", "Cover Height (cm)", "Distance To Cover (cm)","Log Diameter (cm)", "Distance To Water (cm)", "Water Depth (cm)", "Percent Water (%)", "Percent Woody Debris (%)", "Percent Floating Vegetation (%)", "Percent Bare Soil (%)", "Mean Temperature (C)", "Eigenvalue", "Explained Variance")

gt(loadings, rownames_to_stub = TRUE, )%>%
  tab_stubhead(label = "Variable (units)")%>%
  cols_label(
    Description = "Description",
    Comp.1 = "PC-1",
    Comp.2 = "PC-2",
    Comp.3 = "PC-3")%>%
  tab_row_group( group = "",
    rows = 1:16
  )%>%
  tab_row_group(
    group = "PCA Statistics",rows = c(17,18))
```

```{r CowPLot, echo=TRUE, fig.height=8, fig.width=12, message=FALSE, warning=FALSE}
xdens<-axis_canvas(p, axis = "x")+
geom_density(data =group, aes(Comp.1, fill = group$Group), alpha = 0.3, size =1)+
scale_fill_manual(values = c("hotpink3","palegreen4","navyblue", "tomato2"))

ydens<-axis_canvas(p, axis = "y", coord_flip = TRUE)+
geom_density(data =group, aes(Comp.2, fill = group$Group), alpha = 0.3, size =1)+
  scale_fill_manual(values = c("hotpink3","palegreen4","navyblue", "tomato2"))+
  coord_flip()

p1<-insert_xaxis_grob(p, xdens, grid::unit(0.2, "null"), position= "top")
p2<-insert_yaxis_grob(p1,ydens, grid::unit(0.2, "null"), position = "right")

ggdraw(p2)
```

**Figure 1:** Principal component analysis of the environmental variables measured for the *A. piscivorus* (cottonmouth) and general available habitat selected comparison sites. Ellipses represent 95% condifence intervals for cottonmouths (grey) and general habitat (black). Mean principal component scores of the intra-specific cottonmouth groups (adult males, adult females, juveniles,  & young of the year [YOY]) plotted. Positive values for PC-1 indicate non-flooded areas with a greater distance from flooded areas, and positive PC-2 values indicate areas with higher thermal sites. Density counts for the cottonmouth conspecifics represented for each PC score, with PC-1 cottonmouth group density above the plot, and PC-2 cottonmouth group density toward the right of the plot.

**Table 2:** Results of the multivariate statistal tests PERMANOVA/PERMDISP based on the Euclidean distance comparing cottonmouth habitat selected and general habitat available to the cottonmouth within the study area.
```{r PERMANOVA/PERMDISP Table, fig.height=4, fig.width=8, message=FALSE, warning=FALSE}
#PERMANOVA
Perm1<-adonis(s1[,c(2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,22)]~ Type, data = s1, method='eu')
Perm1<-cbind(Perm1$aov.tab[1,4], Perm1$aov.tab[1,6])

#PERMDISP
dist<-dist(scale(s1[,c(2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,22)]))
bd<-anova(betadisper(dist,s1$Type))
betadisper(dist,s1$Type)
bd1<-cbind(bd$`F value`, bd$`Pr(>F)`)
bd1<-data.frame(bd1)
bd1<-bd1[-2,]
PermDisp<- cbind(Perm1, bd1)
names(PermDisp)<-c("Pseudo-F", "P", "F", "P ")
row.names(PermDisp)<-c("Proportions (Euclidean)")

gt(PermDisp, rownames_to_stub = TRUE)%>%
  fmt_number(columns = c(1,3),
             decimals = 2,
             suffixing = T)%>%
    fmt_scientific(columns = c(2,4),
             decimals = 2)%>%
  tab_spanner(
    label = "PERMANOVA", columns = 1:2)%>%
  tab_spanner(
    label = "PERMDISP", columns = 3:4)%>%
  tab_source_note(
    source_note = "N(permutations) = 999")%>%
  tab_source_note(
    source_note = "df = 1")
```

## Habitat Selection: Intra-specific Differences 

The ANOVA test on the principal component scores investigating intra-specific habitat selection differences among the cottonmouth population found no significant difference among groups within PC-1 and PC-3 (PC-1: df = 3,  F = 1.68, P = 0.17; PC-3: df = 3, F = 0.129, P = 0.94; Table 3). However, there was significance in habitat selection among cottonmouths within PC-2 (PC-2: df = 3, F = 3.619, P= 0.015; Table 3).  The Tukey’s HSD test, on the ANOVA of PC-2, found that mean component scores of adult females were significantly different than YOY (Tukey’s HSD; P = 0.023). Adult females were more negatively associated with thermal quality sites (PC-2) compared to YOY with a mean component score difference of 1.25.  

Linear regression comparing PC-1 and body size (SVL) found a significant negative correlation (F = 3.29; P <0.01; d.f. = 1; Fig 2), indicating that larger individuals were found in more flooded habitat sites compared to smaller individuals. Caution must be used in interpreting the results as this relationship as it had a low explanatory power in PC-1 (19.6%) and R2 (0.03) value.

**Table 3:**Mean component scores of PCA on intra-specific habitat selection within cottonmouths with ANOVAs used to compare conspecific groups.

```{r ANOVA Table, message=FALSE, warning=FALSE}
pcomp<-pcomp[,2:4]
names(pcomp)<- c( "PC-1","PC-2", "PC-3")
row.names(pcomp)<-c("Female", "Juvenile", "Male", "YOY")
pcomp[,1:3]<-round(pcomp[,1:3], digits = 3)

C1<-aov(Comp.1~Group, group)
C2<-aov(Comp.2~Group, group)
C3<-aov(Comp.3~Group, group)

F.value<-c(anova(C1)$"F value"[1], anova(C2)$"F value"[1], anova(C3)$"F value"[1])
p.value<-c(anova(C1)$"Pr(>F)"[1],anova(C2)$"Pr(>F)"[1],anova(C3)$"Pr(>F)"[1])

stats<-data.frame(t(cbind(F.value, p.value)))
names(stats)<-c( "PC-1","PC-2", "PC-3")
pcomp<-rbind(pcomp,stats)

row.names(pcomp)<-c("Female", "Juvenile", "Male", "YOY", "F", "P-value")
pcomp<-round(pcomp, digits = 3)

gt(pcomp, rownames_to_stub = TRUE)%>%
  tab_stubhead(label = "Cottonmouth conspecific")%>%
  tab_row_group( group = "",
    rows = 1:4
  )%>%
  tab_row_group(
    group = "ANOVA",rows = c(5,6))
```

```{r Tukey HSD, message=FALSE, warning=FALSE}
#PC-1
TukeyHSD(C1)
#PC-2
TukeyHSD(C2)
#PC-3
TukeyHSD(C3)
```

```{r Linear Regression, fig.height=8, fig.width=15, message=FALSE, warning=FALSE}
#Linear Regression
mod<-lm(SVL~Comp.1,group)
mod2<-lm(SVL~Comp.2,group)
mod3<-lm(SVL~Comp.3,group)

LR1<-ggplot(group, aes(x= SVL, y= Comp.1))+
  geom_point(size = 2)+
  xlim(209, 1061)+
  geom_smooth(method = "lm", color= "black")+
  geom_hline(yintercept = 0, lty = 2) +
  geom_vline(xintercept = 600, lty = 2)+
  theme_bw(base_size = 24)+
  #geom_text(aes(900, 6, label = paste("R-squared = 0.034")), color="black")+
  geom_text(aes(900, 2.95, label = paste("P= 0.023*")), color = "black", size=8)+
  xlab("Snout-vent length (mm)")+
  ylab(expression(atop("aquatic site" %<->% "terrestrial sites", paste("PC-1 (22.6%)" ))))+
  ylim(-3,3)+
  guides(shape = "none")+
  theme(panel.grid = element_blank(), panel.border = element_rect(fill= "transparent"))

LR2<-ggplot(group, aes(x= SVL, y= Comp.2))+
  geom_point(size = 2)+
  xlim(209, 1061)+
  geom_smooth(method = "lm", color= "black")+
  geom_hline(yintercept = 0, lty = 2) +
  geom_vline(xintercept = 600, lty = 2)+
  theme_bw(base_size = 24)+
  #geom_text(aes(900, 6, label = paste("R-squared = 0.045")), color="black")+
  geom_text(aes(900, 2.95, label = paste("P= 0.008*")), color = "black", size = 8)+
  xlab("Snout-vent length (mm)")+
  ylab(expression(atop("low cover" %<->% "high cover", paste("PC-2 (11.8%)" ))))+
  ylim(-3,3)+
  guides(shape = "none")+
  theme(panel.grid = element_blank(), panel.border = element_rect(fill= "transparent"))

LR3<-ggplot(group, aes(x= SVL, y= Comp.3))+
  geom_point(size = 2)+
  xlim(209, 1061)+
  geom_smooth(method = "lm", color= "black")+
  geom_hline(yintercept = 0, lty = 2) +
  geom_vline(xintercept = 600, lty = 2)+
  theme_bw(base_size = 24)+
  #geom_text(aes(900, 6, label = paste("R-squared = 0.045")), color="black")+
  geom_text(aes(900, 2.95, label = paste("P= 0.49")), color = "black", size = 8)+
  xlab("Snout-vent length (mm)")+
  ylab(expression(atop("low vegetation" %<->% "high vegetation", paste("PC-3 (9.2%)" ))))+
  ylim(-3,3)+
  guides(shape = "none")+
  theme(panel.grid = element_blank(), panel.border = element_rect(fill= "transparent"))

plot_grid(LR1, LR2, LR3, labels=c("A)", "B)", "C)"), ncol = 3, nrow = 1)
```

**Figure 2 A & B:** Linear regression of Principal Component scores for the comparison of habitat selection among the intra-specific cottonmouth groups(Males, Females, Juveniles, and Neonates) and their snout-vent lengths.

```{r Linear Summary}
summary(mod)
summary(mod2)
summary(mod3)
```


## Habitat Selection: Modeling Habitat Preference 

Prior to developing the Random Forest models, we used a tested multicollinearity on the sixteen environmental variables and found that percent land and percent water were highly correlated as well as substrate, surface, and ambient temperatures. We chose to excluded percent land, surface temp, and substrate temp from the models. Random forest models (30-iterations) had a mean accuracy of 82.1% from cross-validation and an 83.6% mean accuracy from the OOB (Table 4).  In addition, the mean of the random forest model’s accuracy metrics had a 64.3% kappa (a measure of agreement between predicted presences and absences with actual presences and absences corrected for agreement that might be due to chance alone), 92.9% sensitivity (the percentage of presences correctly classified), 71.4% specificity (the percentage of absences correctly classified), and 87.5% for the area under the receiver operating characteristic curve (AUC) (Table 4) (Cutler et al. 2007). Cross-validation metrics all shared similar accuracies; however, the maximum RF model had an 84.4% OOB accuracy and 89.4% AUC supporting that we had a good predictive model (Table 4). Random forest models error rates stabilized at approximately 3,000 trees, indicating that 5,000 trees were adequate.  

Our maximum-accuracy RF model identified that distance to water (cm), water depth (cm), percent bare soil (%), and percent water (%) were the most important predictors in identifying the occurrence of a cottonmouth within an area. The medium importance environmental variables were canopy closure (%), distance to a cover object (%), and percent floating vegetation (%). To clarify, the important predictor variables validate cottonmouths strong association to swamp habitat. Partial dependence found that the probability of occurrence of a cottonmouth was negatively related to site distance from a water source (Fig 4A). Response to water depth sharply increased from 0 – 20 cm and then decreased in occurrence as depth increased past 25 cm (Fig 4B). Response to water cover increased in occurrence and then plateaued past 10% cover and the response to bare soil cover increased up to 30% and then slightly declined in cottonmouth occurrence (Fig 4 C & D).

```{r Feature Selection by MIR, eval=FALSE, message=FALSE, warning=FALSE, include=FALSE}
rf<-s1[,c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,22)]
set.seed(111)
#Model Improvement Ratio by Cutler et al. 2010
#Train & Test
set.seed(123)
ind<-sample(2,nrow(rf),replace = T, prob = c(0.75,0.25))
train<-rf[ind==1,]
test<-rf[ind==2,]

#Random Forest
RF<-randomForest(Type~.,train, ntree= 6000, importance= T)
RF

#OOB = 16.12; class = 0.151/0.1727

# MIR > 0
A<-data.frame(randomForest::importance(RF))
A
A<-data.frame(A[,2])
sum<-sum(A)
A<-A/sum
A
#Remove 8 Cover Height

#MIR > 0.02
rf<-s[,c(1,2,3,4,5,6,7,9,10,11,12,13,14,15,16,19)]

#Train & Test
set.seed(123)
ind<-sample(2,nrow(rf),replace = T, prob = c(0.75,0.25))
train<-rf[ind==1,]
test<-rf[ind==2,]

#Random Forest
RF<-randomForest(Type~.,train, ntree= 6000, importance= T)
RF

#OOB = 16.94, class= 0.151/0.190
A<-data.frame(randomForest::importance(RF))
A
A<-data.frame(A[,2])
sum<-sum(A)
A<-A/sum
A
# Remove Canopy Cover 1

#MIR > 0.04

rf<-s[,c(1,3,4,5,6,7,9,10,11,12,13,14,15,16,19)]

set.seed(123)
ind<-sample(2,nrow(rf),replace = T, prob = c(0.75,0.25))
train<-rf[ind==1,]
test<-rf[ind==2,]

#Random Forest
RF<-randomForest(Type~.,train, ntree= 6000, importance= T)
RF

#OOB = 17.36, class= 0.151/0.20
A<-data.frame(randomForest::importance(RF))
A
A<-data.frame(A[,2])
sum<-sum(A)
A<-A/sum
A

#Remove 5 WSH, 6 dist, 7 log diam, 12 floating veg

#MIR > 0.06
rf<-s[,c(1,3,4,5,6,11,12,13,14,16,19)]

set.seed(123)
ind<-sample(2,nrow(rf),replace = T, prob = c(0.75,0.25))
train<-rf[ind==1,]
test<-rf[ind==2,]

#Random Forest
RF<-randomForest(Type~.,train, ntree= 6000, importance= T)
RF

#OOB = 18.18, class= 0.189/0.172
A<-data.frame(randomForest::importance(RF))
A
A<-data.frame(A[,2])
sum<-sum(A)
A<-A/sum
A
# Remove Veg, Depth, & Woody Debris

#MIR > 0.08
rf<-s[,c(1,3,5,6,11,13,16,19)]

set.seed(123)
ind<-sample(2,nrow(rf),replace = T, prob = c(0.75,0.25))
train<-rf[ind==1,]
test<-rf[ind==2,]

#Random Forest
RF<-randomForest(Type~.,train, ntree= 6000, importance= T)
RF

#OOB = 21.07, class= 0.181/0.245
A<-data.frame(randomForest::importance(RF))
A
A<-data.frame(A[,2])
sum<-sum(A)
A<-A/sum
A

#Removed Veg, and Fallen Log Cover

#MIR = 0.1
rf<-s[,c(1,3,11,13,16,19)]

set.seed(123)
ind<-sample(2,nrow(rf),replace = T, prob = c(0.75,0.25))
train<-rf[ind==1,]
test<-rf[ind==2,]

#Random Forest
RF<-randomForest(Type~.,train, ntree= 6000, importance= T)
RF

#OOB = 22.31, class= 0.242/0.20
A<-data.frame(randomForest::importance(RF))
A
A<-data.frame(A[,2])
sum<-sum(A)
A<-A/sum
A
```

```{r}
#Went with the Full Model
rf<-s1[,c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,22)]
```


```{r 10-fold cross validation}
#Setting up Cross Validation Training and Validation sets
set.seed(123)
ind<-sample(2,nrow(rf),replace = T, prob = c(0.9,0.1))
train<-rf[ind==1,]
test<-rf[ind==2,]
```

```{r 30 iterations, message=FALSE, warning=FALSE, include=FALSE, paged.print=FALSE}
set.seed(111)
a1<- randomForest(Type~., data = train, ntree = 6000, importance = T)
a2<- randomForest(Type~., data = train, ntree = 6000, importance = T)
a3<- randomForest(Type~., data = train, ntree = 6000, importance = T)
a4<- randomForest(Type~., data = train, ntree = 6000, importance = T)
a5<- randomForest(Type~., data = train, ntree = 6000, importance = T)
a6<- randomForest(Type~., data = train, ntree = 6000, importance = T)
a7<- randomForest(Type~., data = train, ntree = 6000, importance = T)
a8<- randomForest(Type~., data = train, ntree = 6000, importance = T)
a9<- randomForest(Type~., data = train, ntree = 6000, importance = T)
a10<- randomForest(Type~., data = train, ntree = 6000, importance = T)
b1<- randomForest(Type~., data = train, ntree = 6000, importance = T)
b2<- randomForest(Type~., data = train, ntree = 6000, importance = T)
b3<- randomForest(Type~., data = train, ntree = 6000, importance = T)
b4<- randomForest(Type~., data = train, ntree = 6000, importance = T)
b5<- randomForest(Type~., data = train, ntree = 6000, importance = T)
b6<- randomForest(Type~., data = train, ntree = 6000, importance = T)
b7<- randomForest(Type~., data = train, ntree = 6000, importance = T)
b8<- randomForest(Type~., data = train, ntree = 6000, importance = T)
b9<- randomForest(Type~., data = train, ntree = 6000, importance = T)
b10<- randomForest(Type~., data = train, ntree = 6000, importance = T)
c1<- randomForest(Type~., data = train, ntree = 6000, importance = T)
c2<- randomForest(Type~., data = train, ntree = 6000, importance = T)
c3<- randomForest(Type~., data = train, ntree = 6000, importance = T)
c4<- randomForest(Type~., data = train, ntree = 6000, importance = T)
c5<- randomForest(Type~., data = train, ntree = 6000, importance = T)
c6<- randomForest(Type~., data = train, ntree = 6000, importance = T)
c7<- randomForest(Type~., data = train, ntree = 6000, importance = T)
c8<- randomForest(Type~., data = train, ntree = 6000, importance = T)
c9<- randomForest(Type~., data = train, ntree = 6000, importance = T)
c10<- randomForest(Type~., data = train, ntree = 6000, importance = T)
```

```{r Error Rate Plot, eval=FALSE, include=FALSE}
#Error rate of Random Forest
plot(a1)
```

```{r Out-of-Bag}
OOB1<-c(a1$err.rate[6000,1],a2$err.rate[6000,1],a3$err.rate[6000,1],a4$err.rate[6000,1],a5$err.rate[6000,1],a6$err.rate[6000,1],
       a7$err.rate[6000,1],a8$err.rate[6000,1],a9$err.rate[6000,1],a10$err.rate[6000,1],b1$err.rate[6000,1],b2$err.rate[6000,1],
       b3$err.rate[6000,1],b4$err.rate[6000,1],b5$err.rate[6000,1],b6$err.rate[6000,1],b7$err.rate[6000,1],b8$err.rate[6000,1],
       b9$err.rate[6000,1],b10$err.rate[6000,1],c1$err.rate[6000,1],c2$err.rate[6000,1],c3$err.rate[6000,1],c4$err.rate[6000,1],
       c5$err.rate[6000,1],c6$err.rate[6000,1],c7$err.rate[6000,1],c8$err.rate[6000,1],c9$err.rate[6000,1],c10$err.rate[6000,1])
OOB<-c(1-min(OOB1),1-mean(OOB1), 1-max(OOB1))
```

```{r Cross-Validation}
files<-list(a1,a2,a3,a4,a5,a6,a7,a8,a9,a10,b1,b2,b3,b4,b5,b6,b7,b8,b9,b10,c1,c2,c3,c4,c5,c6,c7,c8,c9,c10)

cv<-(function(x){
p<-predict(x, test)
cm<-caret::confusionMatrix(p, positive = "SNAKE",test$Type)

CVTABLE<-t(data.frame(cm$overall))
CV2TABLE<-t(data.frame(cm$byClass))

cv_table<-cbind(CVTABLE,CV2TABLE)
cv_table<-cv_table[,c(1,2,8,9)]
cv_table
})

cv_table<-t(data.frame(lapply(files, cv)))

cv_max<-c(max(cv_table[,1]), max(cv_table[,2]), max(cv_table[,3]), max(cv_table[,4]))
cv_mean<-c(mean(cv_table[,1]), mean(cv_table[,2]), mean(cv_table[,3]), mean(cv_table[,4]))
cv_min<-c(min(cv_table[,1]), min(cv_table[,2]), min(cv_table[,3]), min(cv_table[,4]))

cv_table<-data.frame(rbind(cv_max,cv_mean, cv_min))

RandomForest_Model<-c("Maximum", "Mean", "Minimum")
```

```{r Calculating AUC}

AUC<- function(z){
pred<-predict(z, test, type = "prob")
pred<-pred[,2]
pred<-prediction(pred, test$Type)

#AUC (Area Under The Curve)
auc<-performance(pred, "auc")
auc<-unlist(slot(auc, "y.values"))
  
}

AUC<-t(data.frame(lapply(files, AUC)))

AUC<-c(max(AUC), mean(AUC), min(AUC))
```

**Table 4:** Performance metrics for the 30-iteration random forest model on cottonmouth habitat selection compared to general habitat available within the study area.

```{r Random Forest Table}
models<-cbind(cv_table, OOB, AUC)
models<-round(models, digits = 3)
models<-cbind(RandomForest_Model,models)
gt(models)%>%
  cols_label(
    RandomForest_Model = "Random Forest Models",
    X1 = "Accuracy",
    X2 = "Kappa",
    X3 = "Sensitivity",
    X4 = "Specificity")%>%
  tab_source_note(
    source_note = "N(trees) = 6000")%>%
  tab_source_note(
    source_note = "OOB = Out of Bag Accuracy")%>%
    tab_source_note(
    source_note = "AUC = Area Under the Curve")
```

```{r Maximum RF Model}
c9 # Maximum Accuracy
a3 #Mean Accuracy
```


```{r Variable Importance}
MDA<-randomForest::importance(c9, class = "SNAKE")
MDA<-data.frame(MDA[,c(1,2)])
gen<-sum(MDA[,1])
sna<-sum(MDA[,2])
#Calculating relative importance of MDA
MDA[,1]<-(MDA[,1]/gen)*100
MDA[,2]<-(MDA[,2]/gen)*100

#Plotting
Habitat_Variables <- c("Canopy Closure", "Rock Cover", "Leaf Cover", "Vegetative Cover","Fallen Log Cover","Woody Stem Height", "Cover Height", "Distance To Cover","Log Diameter","Distance To Water", "Water Depth", "Percent Water", "Percent Woody Debris", "Percent Floating Vegetation", "Percent Bare Soil", "Mean Temperature")

D<-cbind(Habitat_Variables,MDA)
row.names(D)<-NULL

Q=ggplot(D, aes(x = reorder(Habitat_Variables, D$SNAKE), y = D$SNAKE))+
  geom_col(aes(fill=D$SNAKE), color = "black", width = 0.9)+
  geom_text(label=round(D$SNAKE,1), nudge_y = 0.5)+
    ylab("Relative Importance")+
  xlab("Environmental Variables")+
  coord_flip()+
  theme_classic(base_size = 12)+ theme(legend.position = "none")

Q<-Q+scale_fill_gradient2(low="white", high="black")
```

```{r Partial Dependence Plots}
#RF a8
plot1<-partial(c9, pred.var = "Dist..To.Water", pdp = T, center = T, plot = T, plot.engine = "ggplot2", type = "classification", which.class = "SNAKE", train = train, rug = T)

plot2<-partial(c9, pred.var = "X.Bare.soil", pdp = T, center = T, plot = T, plot.engine = "ggplot2", type = "classification", which.class = "SNAKE", train = train, rug = T)

plot3<-partial(c9, pred.var = "Rock.Cover", pdp = T, center = T, plot = T, plot.engine = "ggplot2", type = "classification", which.class = "SNAKE", train = train, rug = T)

plot4<-partial(c9, pred.var = "Depth", pdp = T, center = T, plot = T, plot.engine = "ggplot2", type = "classification", which.class = "SNAKE", train = train, rug = T)

plot5<-partial(c9, pred.var = "X.Water", pdp = T, center = T, plot = T, plot.engine = "ggplot2", type = "classification", which.class = "SNAKE", train = train, rug = T)

plot6<-partial(c9, pred.var = "Dist..To.Cover", pdp = T, center = T, plot = T, plot.engine = "ggplot2", type = "classification", which.class = "SNAKE", train = train, rug = T)

#GGPLOT

plot1<-plot2+ geom_line(size = 1.5)+
  xlab("Bare soil cover (%)")+
  ylab("Relative probability")+
  xlim(0,105)+
  theme_light(base_size = 12)

plot2<-plot1+geom_line(size = 1.5)+
  xlab("Distance to Water (cm)")+
  ylab("")+
  ylim(-0.8, 0.5)+
  theme_light(base_size = 12)

plot3<-plot3+ geom_line(size = 1.5)+
  xlab("Rock cover (%)")+
  ylab("")+
  xlim(0,105)+
  ylim(-1,0)+
  theme_light(base_size = 12)

plot4<-plot4+ geom_line(size = 1.5)+
  xlab("Water Depth (cm)")+
  ylab("Relative probability")+
  xlim(0,105)+
  theme_light(base_size = 12)

plot5<-plot5+ geom_line(size = 1.5)+
  xlab("Water Cover (%)")+
  ylab("")+
  xlim(0,105)+
  theme_light(base_size = 12)

plot6<-plot6+ geom_line(size = 1.5)+
  xlab("Distance to Cover (cm)")+
  ylab("")+
  theme_light(base_size = 12)
```

```{r Variable importance Plot, fig.height=6, fig.width=10}
Q
```

**Figure 3:** The Relative Importance (based on the Mean Decrease Accuracy) on the environmental variables from the minimum error rate random forest model on Cottonmouth (Agkistrodon piscivorus) habitat selection in Middle TN, USA. Cover variables were measured in percentage of occurance within a 1-m^2 quadrat, and all other metrics were measured in cm.

```{r Partial Dependance Plots, fig.height=8, fig.width=12, message=FALSE, warning=FALSE}
plot_grid(plot1, plot2,plot3,plot4,plot5,plot6, labels=c("A ", "B ", "C ","D ", "E ", "F "), ncol = 3, nrow = 2)
```

**Figure 4:** Partial dependance plots of the four most constributing variables (From mean decrease accuracy) with relative probability of cottonmouth habitat selection of a site within Middle Tennessee, USA. Distance to water (A), bare soil cover (B), rock cover (C), and water depth (D) were measured within and above a 1-m^2 quadrat from were a cottonmouth was located during visual encounter. Dashes on the x-axis indicate the deciles of the cottonmouth occurence for each environmental variables.

# **Discussion**

Cottonmouths are pretty generalist, manly sticking to the swamp, but can be found in the terrestrial zones of the study area. Also, there is a presence of an ontogenetic shift in both terrestrial to wetland habitat, as well as being near more cover objects.

# **References** 
Anderson, M. J. 2017. Permutational Multivariate Analysis of Variance (PERMANOVA). Wiley StatsRef: Statistics Reference Online:1–15. 

Anderson, M. J., K. E. Ellingsen, and B. H. McArdle. 2006. Multivariate dispersion as a measure of beta diversity. Ecology Letters 9:683–693. 

Archer, K. J., and R. V. Kimes. 2008. Empirical characterization of random forest variable importance measures. Computational Statistics and Data Analysis 52:2249–2260. 

Assis, J., B. Claro, A. Ramos, J. Boavida, and E. A. Serrão. 2013. Performing fish counts with a wide-angle camera, a promising approach reducing divers’ limitations. Journal of Experimental Marine Biology and Ecology 445:93–98. 

Blanchard, F, N., and B. Finister, E. 1933. A method of marking living snakes for future recognition, with a discussion of some problems and results. Ecology 14:334–347. 

Breiman, L. 2001. Random Forest. Machine Learning 45:5–32. 

Breiman, L., A. Cutler, A. Liaw, and M. Wiener. 2018. Breiman and Cutler’s Random Forests for Classification and Regression “randomForest.” CRAN. 

Brückner, A., and M. Heethoff. 2017. A chemo-ecologists’ practical guide to compositional data analysis. Chemoecology 27:33–46. 

Burkett, Ray, D. 1966. Natural history of cottonmouth moccasin, <i>Agkistrodon piscivorus<i/> (Reptilia). University of Kansas Publications 17:435–491. 

Cutler, D. R., T. C. Edwards, K. H. Beard, A. Cutler, T. Kyle, J. Gibson, J. J. Lawler, H. Beard, and T. Hess. 2007. Random Forests for Classification in Ecology Published by : Ecological Society of America. Ecology 88:2783–2792. 

Delgado-Baquerizo, M., A. Gallardo, F. Covelo, A. Prado-Comesaña, V. Ochoa, and F. T. Maestre. 2015. Differences in thallus chemistry are related to species-specific effects of biocrust-forming lichens on soil nutrients and microbial communities. Functional Ecology 29:1087–1098. 

Dormann, C. F., J. Elith, S. Bacher, C. Buchmann, G. Carl, G. Carré, J. R. G. Marquéz, B. Gruber, B. Lafourcade, P. J. Leitão, T. Münkemüller, C. Mcclean, P. E. Osborne, B. Reineking, B. Schröder, A. K. Skidmore, D. Zurell, and S. Lautenbach. 2013. Collinearity: A review of methods to deal with it and a simulation study evaluating their performance. Ecography 36:027–046. 

Eskew, E. A., J. D. Willson, and C. T. Winne. 2009. Ambush site selection and ontogenetic shifts in foraging strategy in a semi-aquatic pit viper, the Eastern cottonmouth. Journal of Zoology 277:179–186. 

Frakes, R. A., R. C. Belden, B. E. Wood, and F. E. James. 2015. Landscape analysis of adult Florida panther habitat. PLoS ONE 10:1–18. 

Guttman, L. 1954. Some necessary conditions for common-factor analysis. Psychometrika 19:149–161. 

Hirzel, A. H., J. Hausser, D. Chessel, and N. Perrin. 2002. Ecological-niche factor analysis: How to compute habitat-suitability maps without absence data? Ecology 83:2027–2036. 

Koons, D. N., R. D. Birkhead, S. M. Boback, M. I. Williams, and M. P. Greene. 2009. The effect of body size on cottonmouth (Agkistrodon piscivorus) survival, recapture probability, and behavior in an Alabama swamp. Herpetological Conservation and Biology 4:221–235. 

Murphy, M. A., J. S. Evans, and A. Storfer. 2010. Quantifying Bufo boreas connectivity in Yellowstone National Park with landscape genetics. Ecology 91:252–261. 

Oksanen, J., M. Guillaume - Blanchet, F. Friendly, R. Kindt, P. Legendre, D. McGlinn, P. R. Minchin, R. B. O’Hara, G. L. Simpson, P. Solymos, M. Henry, H. Stevens, E. Szoecs, and H. Wagner. 2019. Community Ecology Package “vegan.” CRAN. 

Pape, R., and J. Löffler. 2015. Seasonality of habitat selection shown to buffer alpine reindeer pastoralism against climate variability. Ecosphere 6:1–18. 

Peres-Neto, P. R., D. A. Jackson, and K. M. Somers. 2003. Giving meaningful interpretation to ordination axes: Assessing loading significance in principal component analysis. Ecology 84:2347–2363. 

Peres-Neto, P. R., D. A. Jackson, and K. M. Somers. 2005. How many principal components? stopping rules for determining the number of non-trivial axes revisited. Computational Statistics and Data Analysis 49:974–997. 

Severson, J. P., C. A. Hagen, J. D. Maestas, D. E. Naugle, J. T. Forbes, and K. P. Reese. 2017. Effects of conifer expansion on greater sage-grouse nesting habitat selection. Journal of Wildlife Management 81:86–95. 

Smith, N. 2009. Studies on selected aspects of the life history of the Western Cottonmouth ( Akgistrodon piscivorus leucostoma) along the Cumberland River Bicentennial Trail, Ashland City, Tennessee. Unpublished M.S. Thesis, Austin Peay State University, Clarksville, Tennessee.
